---
import "../styles/global.css";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import  SpeedInsights  from "@vercel/speed-insights/astro";
import { getAssetPath } from "../utils/assets";

const {
  pageTitle = "Raffy James Adams - Professional Portfolio | Graphic Designer | Audio Specialist | Administrative Support",
  description = "Professional portfolio of Raffy James Adams (RJADAMS) - Expert Graphic Designer, Audio Specialist, and Administrative Support professional. View my work, skills, and get in touch for your next project.",
  keywords = "Raffy James Adams, RJADAMS, Graphic Designer, Audio Specialist, Administrative Support, Portfolio, Freelancer, Philippines, Web Design, Logo Design, Podcast Editing, Audio Production, Virtual Assistant",
  ogimage = {
    url: getAssetPath("/images/rjadamsprofile.webp"),
    alt: "Raffy James Adams - Professional Portfolio",
  },
} = Astro.props;

const siteUrl = "https://qwertyjames23.github.io/Portfolio";
const currentUrl = `${siteUrl}${Astro.url.pathname}`;

const SEO = {
  sitename: "Raffy James Adams Portfolio",
  url: siteUrl,
  locale: "en_US",
  author: "Raffy James Adams",
  twitter: "@rjadams23",
  linkedin: "https://www.linkedin.com/in/raffy-james-adams-779562325/",
  github: "https://github.com/qwertyjames23",
};

const twitterimage = `${siteUrl}${ogimage.url}`;
---

<html
  lang="en"
  class="dark:bg-[#0E0E11] bg-mint-50/5 font-montserrat scroll-smooth"
>
  <head>
    <!-- Preconnect to external domains for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://github.com" crossorigin>
    <link rel="preconnect" href="https://www.linkedin.com" crossorigin>
    
    <!-- DNS Prefetch for social media -->
    <link rel="dns-prefetch" href="//instagram.com">
    <link rel="dns-prefetch" href="//twitter.com">
    
    <!-- Preload critical assets -->
    <link rel="preload" as="image" href={getAssetPath("/images/rjadamsprofile.webp")} type="image/webp">
    
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{pageTitle}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="author" content={SEO.author} />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <link rel="canonical" href={currentUrl} />
    
    <!-- Geographic and Contact Information -->
    <meta name="geo.region" content="PH" />
    <meta name="geo.country" content="Philippines" />
    <meta name="contact" content="raffyjamesadams5@gmail.com" />
    
    <!-- Favicon for different platforms -->
    <link rel="icon" href={getAssetPath("/favicon-32x32.png")} sizes="32x32" />
    <link rel="icon" href={getAssetPath("/favicon-16x16.png")} sizes="16x16" />
    <link rel="apple-touch-icon" href={getAssetPath("/apple-touch-icon.png")} />
    <link rel="icon" href={getAssetPath("/android-chrome-192x192.png")} sizes="192x192" />
    <link rel="icon" href={getAssetPath("/android-chrome-512x512.png")} sizes="512x512" />

    <!-- Web manifest -->
    <link rel="manifest" href={getAssetPath("/site.webmanifest")} />
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={twitterimage} />
    <meta property="og:image:alt" content={ogimage.alt} />
    <meta property="og:url" content={currentUrl} />
    <meta property="og:site_name" content={SEO.sitename} />
    <meta property="og:locale" content={SEO.locale} />
    <meta property="profile:first_name" content="Raffy James" />
    <meta property="profile:last_name" content="Adams" />
    <meta property="profile:username" content="RJADAMS" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content={SEO.twitter} />
    <meta name="twitter:creator" content={SEO.twitter} />
    <meta name="twitter:title" content={pageTitle} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={twitterimage} />
    <meta name="twitter:image:alt" content={ogimage.alt} />
    
    <!-- LinkedIn -->
    <meta property="linkedin:owner" content={SEO.linkedin} />
    
    <!-- Schema.org structured data for Person -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Raffy James Adams",
        "alternateName": "RJADAMS",
        "description": "Professional Graphic Designer, Audio Specialist, and Administrative Support expert",
        "url": siteUrl,
        "image": twitterimage,
        "sameAs": [
          "https://www.linkedin.com/in/raffy-james-adams-779562325/",
          "https://github.com/qwertyjames23",
          "https://www.instagram.com/rjadams23/"
        ],
        "jobTitle": "Graphic Designer, Audio Specialist, Administrative Support",
        "worksFor": {
          "@type": "Person",
          "name": "Freelancer"
        },
        "knowsAbout": [
          "Graphic Design",
          "Audio Production",
          "Administrative Support",
          "Podcast Editing",
          "Logo Design",
          "Virtual Assistant"
        ],
        "email": "raffyjamesadams5@gmail.com",
        "nationality": "Filipino"
      })}
    </script>
  
    <meta name="theme-color" content="#0E0E11"/>

    <!-- Sitemap -->
    <link rel="sitemap" href={getAssetPath("/sitemap-index.xml")} />
    
    <!-- Additional SEO -->
    <meta name="language" content="en" />
    <meta name="revisit-after" content="7 days" />
    <meta name="rating" content="general" />
    
  </head>
  <body class="overflow-x-hidden">
    <!-- Page Loading Indicator -->
    <div id="loading-overlay" class="fixed inset-0 bg-white dark:bg-gray-900 z-50 flex items-center justify-center transition-opacity duration-500">
      <div class="text-center">
        <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-mint-500 mx-auto mb-4"></div>
        <p class="text-mint-600 dark:text-mint-400 font-medium">Loading Portfolio...</p>
      </div>
    </div>

    <SpeedInsights/>
    <div class="blur-circle"></div>
    <div
      style="  background:linear-gradient(45deg, rgba(96, 250, 155, 0) 10.79%, rgba(96, 250, 170, 0.03) 40.92%, rgba(96, 250, 155, 0) 90.35%)"
      class="fixed top-0 left-0 w-full h-full pointer-events-none -z-1"
    >
    </div>
    <Header />

    <div class="min-h-[85vh] ">
      <slot />
    </div>

    <Footer />
    
    <!-- Performance and Loading Scripts -->
    <script>
      import "../scripts/menu.js";
      
      // Page Loading Performance
      document.addEventListener('DOMContentLoaded', () => {
        // Hide loading overlay after content loads
        const loadingOverlay = document.getElementById('loading-overlay');
        if (loadingOverlay) {
          setTimeout(() => {
            loadingOverlay.style.opacity = '0';
            setTimeout(() => {
              loadingOverlay.remove();
            }, 500);
          }, 300);
        }

        // Performance monitoring
        if ('performance' in window) {
          window.addEventListener('load', () => {
            const perfData = performance.getEntriesByType('navigation')[0];
            console.log('Page Load Performance:');
            console.log(`DOM Content Loaded: ${perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart}ms`);
            console.log(`Total Load Time: ${perfData.loadEventEnd - perfData.loadEventStart}ms`);
          });
        }

        // Image lazy loading fallback for older browsers
        if (!('IntersectionObserver' in window)) {
          const images = document.querySelectorAll('img[loading="lazy"]');
          images.forEach(img => {
            img.loading = 'eager';
          });
        }

        // Preload critical images on hover
        const projectLinks = document.querySelectorAll('a[href*="portfolio"]');
        projectLinks.forEach(link => {
          link.addEventListener('mouseenter', () => {
            const img = link.querySelector('img');
            if (img && img.dataset.preload !== 'true') {
              img.dataset.preload = 'true';
              const preloadImg = new Image();
              preloadImg.src = img.src;
            }
          });
        });
      });

      // Service Worker for offline caching (optional)
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => console.log('SW registered'))
            .catch(error => console.log('SW registration failed'));
        });
      }
    </script>
  </body>
</html>
