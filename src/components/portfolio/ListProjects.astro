---
import Project from "./Project.astro";
import Heading from "../ui/Heading.astro";
import { Icon } from "astro-icon/components";

const allPosts = await Astro.glob("../../pages/portfolio/projects/*.md");

// Sort by descending date (most recent first)
allPosts.sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).getTime() -
    new Date(a.frontmatter.pubDate).getTime(),
);
---

<section
  class="bg-linear-to-t dark:from-[#0e0e10] from-white from-50% to-transparent to-100% scroll-m-16 relative pt-8 pb-32 max-2xl:px-8 max-md:pt-4"
  id="portfolio"
>
  <div class="mx-auto max-w-7xl py-8">
    <div class="flex gap-4 items-center justify-center text-center">
      <Icon class="text-3xl dark:text-white text-blacktext" name="briefcase" />
      <Heading text="Portfolio" textGradient="Showcase" level={2} />
    </div>

    <p
      class="z-2 text-center mx-auto text-lg max-xl:text-base max-w-2xl dark:text-gray-200 text-blacktext my-6 leading-6 font-medium"
    >
      I love <b
        class="bg-linear-to-r from-riptide-500 to-mint-500 dark:from-riptide-300 dark:to-mint-200 text-transparent bg-clip-text"
        >bringing creative solutions to life.</b
      >
      <br /> Here I showcase my work across <b
        class="bg-linear-to-r from-riptide-500 to-mint-500 dark:from-riptide-300 dark:to-mint-200 text-transparent bg-clip-text"
        >three specialties</b
      >: Graphic Design, Audio Production, and Administrative Excellence.
      <b
        class="bg-linear-to-r from-riptide-500 to-mint-500 dark:from-riptide-300 dark:to-mint-200 text-transparent bg-clip-text"
        >Explore my work!</b
      >
    </p>
    <slot />
  </div>

  <!-- Portfolio Categories -->
  <div class="mx-auto max-w-7xl grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
    <!-- Graphic Design -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
      <div class="flex items-center gap-3 mb-4">
        <Icon class="text-2xl text-mint-500" name="briefcase" />
        <h3 class="text-xl font-bold dark:text-white">Graphic Design</h3>
      </div>
      <ul class="space-y-2 text-gray-600 dark:text-gray-300 text-sm">
        <li>• Visual Identity & Branding</li>
        <li>• Design and Layout</li>
        <li>• Type & Color Harmony</li>
        <li>• Digital Content Creation</li>
        <li>• Print & Marketing Assets</li>
      </ul>
      <div class="mt-4 flex flex-wrap gap-2">
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Photoshop</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Illustrator</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Canva</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Figma</span>
      </div>
      <a href="/portfolio/graphic-design" class="inline-block mt-4 text-mint-500 hover:text-mint-600 font-medium transition-colors">View Projects →</a>
    </div>

    <!-- Audio Specialist -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
      <div class="flex items-center gap-3 mb-4">
        <Icon class="text-2xl text-mint-500" name="briefcase" />
        <h3 class="text-xl font-bold dark:text-white">Audio Specialist</h3>
      </div>
      <ul class="space-y-2 text-gray-600 dark:text-gray-300 text-sm">
        <li>• Audio Editing & Mixing</li>
        <li>• Vocal Separation & Isolation</li>
        <li>• Noise Reduction & Restoration</li>
        <li>• Podcast Editing & Production</li>
        <li>• Sound Design & Mastering</li>
      </ul>
      <div class="mt-4 flex flex-wrap gap-2">
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Studio One</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">FL Studio</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Ableton</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Audacity</span>
      </div>
      <a href="/portfolio/audio-specialist" class="inline-block mt-4 text-mint-500 hover:text-mint-600 font-medium transition-colors">View Projects →</a>
    </div>

    <!-- Administrative Support -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
      <div class="flex items-center gap-3 mb-4">
        <Icon class="text-2xl text-mint-500" name="briefcase" />
        <h3 class="text-xl font-bold dark:text-white">Administrative Support</h3>
      </div>
      <ul class="space-y-2 text-gray-600 dark:text-gray-300 text-sm">
        <li>• Email & Calendar Management</li>
        <li>• Data Entry & Database Mgmt</li>
        <li>• Document Preparation</li>
        <li>• Scheduling & Task Coordination</li>
        <li>• Research & File Management</li>
      </ul>
      <div class="mt-4 flex flex-wrap gap-2">
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Google Workspace</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">MS Office 365</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Trello</span>
        <span class="bg-mint-100 dark:bg-mint-900 text-mint-800 dark:text-mint-200 px-2 py-1 rounded text-xs">Notion</span>
      </div>
      <a href="/portfolio/administrative-support" class="inline-block mt-4 text-mint-500 hover:text-mint-600 font-medium transition-colors">View Projects →</a>
    </div>
  </div>

  <div
    id="containerProjects"
    class="mx-auto max-w-7xl grid grid-cols-3 max-lg:grid-cols-2 max-md:grid-cols-1 gap-5 p-2 py-4 max-h-[150vh] overflow-hidden transition-[max-height] duration-500 ease-in-out"
  >
    {
      allPosts.map((post) => (
        <Project
          url={post.url}
          title={post.frontmatter.title}
          description={post.frontmatter.description}
          date={post.frontmatter.pubDate}
          languages={post.frontmatter.languages}
          image={post.frontmatter.image}
        />
      ))
    }
  </div>

  <div
    id="moreProjects"
    class="absolute bottom-0 left-0 w-full flex justify-center text-center bg-linear-to-t from-[#FBFEFD] dark:from-[#0e0e10] from-55% to-transparent to-100% pb-30 pt-52"
  >
    <button
      class="absolute font-bold cursor-pointer text-mint-400 dark:text-mint-100 hover:text-mint-500 dark:hover:text-mint-300 transition-all"
    >
      View More Projects...
    </button>
  </div>
</section>

<script>
  document.querySelector("#moreProjects")?.addEventListener("click", () => {
    const container = document.querySelector("#containerProjects");
    const moreProjectsBtn = document.querySelector("#moreProjects");

    if (container && moreProjectsBtn) {
      // Expand container to show all projects
      container.classList.remove("h-[150vh]");
      container.classList.remove("h-auto");
      // Hide the "View More" button after animation completes
      moreProjectsBtn.classList.add("hidden");
      setTimeout(() => {
        moreProjectsBtn.classList.add("hidden");
      }, 500);
    }
  });
</script>
